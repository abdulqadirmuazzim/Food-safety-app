#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import Gradient kivy_gradient.Gradient



ScreenManager:
    WelcomeScreen:
    ProductInfo:
    CameraPage:


<WelcomeScreen>:
    name: 'welcome'

    BoxLayout:
        height: root.height
        width: root.width
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0.0, 0.2, 0.1, 1  # Dark green background
            Rectangle:
                pos: self.pos
                size: self.size

        BoxLayout:
            orientation: "vertical"
            size_hint: (1, 0.5)
            canvas:
                Color:
                    rgba: 48/255, 242/255, 132/255

                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [0, 0, 50, 50]
                    texture: Gradient.horizontal(get_color_from_hex("2647bf"), get_color_from_hex("2ca342"))

            Label:
                text: "WELCOME"
                font_size: 40
                color: 1, 1, 1, 1
                font_name: "Roboto"

        FloatLayout:
            size_hint: 1.0, 0.5
            canvas.before:
                Color:
                    rgba: 1, 1, 0, 1

            Button:
                text: "Scan product"
                font_size: 20
                size_hint: (None, None)
                height: 70
                width: 200
                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                background_color: get_color_from_hex("0c8dc4") # 0, 0.2, 0.8, 1
                background_normal: ""
                on_press: root.scan_prod()
                on_release:
                    app.root.current = 'product_info'

# product info page
<ProductInfo>:

    name: 'product_info'
    update: update_btn
    grid: info_grid
    textInput: fat
    nutri_grade: nutrient_grade

    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0.0, 0.2, 0.1, 1  # Dark green background
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "PRODUCT INFORMATION"
            font_size: 24
            size_hint_y: None
            height: 50
            color: 1, 1, 1, 1

        Label:
            text: "65942000123"
            font_size: 22
            color: 1, 1, 1, 1
            size_hint_y: None
            height: 40

        GridLayout:
            id: info_grid
            cols: 2
            spacing: 10
            size_hint_y: None
            height: self.minimum_height
            padding: [20, 20]

            Label:
                text: "Energy (Kj) *required:"
                font_size: 22
                color: 1, 1, 1, 1
                size_hint_y: None
                height: 40

            TextInput:
                id: fat
                text: "28"
                font_size: 20
                size_hint_y: None
                height: 40
                readonly: True
                background_color: 0, 0, 0, 1
                foreground_color: 1, 1, 1, 1
                cursor_color: 1, 1, 1, 1

            Label:
                text: "Fat (g)"
                font_size: 22
                color: 1, 1, 1, 1
                size_hint_y: None
                height: 40

            TextInput:
                id: fat
                text: "15"
                font_size: 20
                size_hint_y: None
                height: 40
                readonly: True
                background_color: 0, 0, 0, 0
                foreground_color: 1, 1, 1, 1
                cursor_color: 1, 1, 1, 1

            Label:
                text: "Saturated Fat (g)"
                font_size: 22
                color: 1, 1, 1, 1
                size_hint_y: None
                height: 40

            TextInput:
                id: fat
                text: "10.7"
                font_size: 20
                size_hint_y: None
                height: 40
                readonly: True
                background_color: 0, 0, 0, 0
                foreground_color: 1, 1, 1, 1
                cursor_color: 1, 1, 1, 1

            Label:
                text: "Protine"
                font_size: 22
                color: 1, 1, 1, 1
                size_hint_y: None
                size_hint_x: 0.3
                align_text: "left"
                height: 40

            TextInput:
                id: fat
                text: "23.5"
                font_size: 20
                size_hint_y: None
                height: 40
                readonly: True
                background_color: 0, 0, 0, 0
                foreground_color: 1, 1, 1, 1
                cursor_color: 1, 0, 1, 1

        BoxLayout:
            orientation: 'vertical'
            padding: [20, 10]
            Label:
                text: "Nutritional Score"
                font_size: 22
                color: 1, 1, 1, 1
                size_hint_y: None
                height: 30
            Label:
                id: nutrient_grade
                text: "B"
                font_size: 50
                color: 1, 1, 1, 1

        BoxLayout:
            spacing: 10
            padding: [20, 10]
            size_hint_y: None
            height: 50
            Button:
                text: "Scan another"
                size_hint_x: 0.5
                background_color: 0, 0.2, 0.8, 1
                on_release:
                    app.root.current = 'welcome'

            Button:
                id: update_btn
                text: "Update Info"
                size_hint_x: 0.5
                background_normal: ""
                background_color: 0, 0.5, 1, 1
                on_press: root.update_info()
                on_release: app.root.current = "camera"


# camera Page
<CameraPage>
    name: "camera"

    orientation: 'vertical'
    Camera:
        id: camera
        resolution: (640, 480)
        play: False
    ToggleButton:
        text: 'Play'
        on_press: camera.play = not camera.play
        size_hint_y: None
        height: '48dp'
    Button:
        text: 'Capture'
        size_hint_y: None
        height: '48dp'
        on_press: root.capture()
